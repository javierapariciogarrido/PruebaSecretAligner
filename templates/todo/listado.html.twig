{% extends 'base.html.twig' %}

{% block title %}LISTAS TODO{% endblock %}

{% block body %}
    
    
    
    <div class="header">
    
    <!-- IR A PORTADA PRINCIPAL -->    
    <a href="{{url('todo_index')}}">PORTADA PRINCIPAL</a>    
        
    <h2>VISUALIZAR LISTADO COMPLETO</h2>    
        <ul>
            {% for elementolista in listatodo %}
                {% if elementolista.estado == 'realizada' %}
                    <li class="verde">
                {% else %}        
                    <li>
                {% endif %}        
                    <ul>
                        <li>Nombre: {{elementolista.nombre}}</li>
                        <li>Creado: {{elementolista.fechaCreacion|date('d-m-Y')}}</li>
                        <li>Fecha Tope: {{elementolista.fechaTope|date('d-m-Y')}}</li>
                        <li>Estado: {{elementolista.estado}}</li>
                        
                        {% if elementolista.estado == 'pendiente' and app.user is not null and app.user.id == elementolista.user.id %}
                            <a href="{{url('todo_modificar_estado',{'id':elementolista.id})}}">Marcar como realizada la tarea</a>
                        {% endif %}
                        
                        {# SI ERES ADMINISTRADOR PUEDES CAMBIAR EL DUEÑO DE LA TAREA #}
                        {% if app.user is not null and app.user.role == 'ROLE_ADMIN' %}
                            <form action="{{url('modificar_propietario')}}" method='POST'>
                                <input type='hidden' name='id_tarea' value='{{elementolista.id}}'
                                <label for="propietario">Cambiar dueño de tarea</label>
                                <select name="propietario" id="estado" >
                                    {% for usuario in todos_usuarios %}
                                        <option value="{{usuario.id}}">{{usuario.nombre}}</option>
                                    {% endfor %}
                                </select>
                                <input type='submit' value='Guardar'>
                            </form>    
                        {% endif %}    
                        
                    </ul>
                <li>----------------------------------------------</li>
                </li>
                
            {%endfor%}    
        </ul>
    </div>    
{% endblock %}







